<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo Ciacollor - Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #f3f4f6; font-family: 'Inter', sans-serif; }
        .product-card { transition: transform 0.2s; cursor: pointer; }
        .product-card:hover { transform: translateY(-2px); shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .modal-overlay { background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px); }
    </style>
</head>
<body>

    <header class="bg-white border-b sticky top-0 z-40 p-4">
        <div class="container mx-auto flex flex-col items-center">
            <div class="w-full flex justify-between items-center mb-4">
                <div class="flex items-center gap-2">
                    <img src="https://www.ciacollor.com.br/assets/images/logo.png" alt="Ciacollor" class="h-8">
                    <span class="font-bold text-slate-700 text-xl italic">Ciacollor</span>
                </div>
                <div id="productCount" class="bg-slate-100 px-3 py-1 rounded-full text-xs font-bold text-slate-500">
                    0 prods
                </div>
            </div>
            <div class="relative w-full max-w-2xl">
                <input type="text" id="mainSearch" placeholder="Buscar..." 
                       class="w-full bg-slate-100 border-none rounded-xl p-3 pl-10 focus:ring-2 focus:ring-blue-500 outline-none">
                <i class="fas fa-search absolute left-4 top-4 text-slate-400"></i>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 max-w-4xl">
        <div id="mainGrid" class="space-y-4 pt-4">
            </div>
    </main>

    <div id="productModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl max-w-lg w-full max-h-[90vh] overflow-y-auto relative shadow-2xl">
            <button onclick="closeModal()" class="absolute top-4 right-4 bg-slate-100 w-10 h-10 rounded-full flex items-center justify-center text-slate-500 hover:bg-slate-200">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="p-8">
                <p id="m-id" class="text-[10px] font-bold text-slate-400 uppercase mb-1">ID: 0000</p>
                <h2 id="m-nombre" class="text-xl font-bold text-slate-800 leading-tight mb-6">Nombre del Producto</h2>
                
                <div class="bg-slate-50 rounded-2xl p-6 flex justify-center mb-6 border border-slate-100">
                    <img id="m-img" src="" alt="Producto" class="max-h-64 object-contain">
                </div>

                <div class="border-2 border-dashed border-blue-200 rounded-xl p-4 flex flex-col items-center justify-center gap-2 mb-6">
                    <div class="text-blue-500 font-bold flex items-center gap-2">
                        <i class="fas fa-upload"></i> Subir / Previsualizar
                    </div>
                    <p class="text-[9px] text-slate-400 text-center uppercase tracking-widest">
                        *Para guardar: nombre la foto como ID.jpg y súbala a la carpeta 'imagenes'
                    </p>
                </div>

                <div class="space-y-4">
                    <h3 class="text-[10px] font-black text-slate-400 uppercase flex items-center gap-2">
                        <i class="fas fa-align-left"></i> Descripción (Español)
                    </h3>
                    <div id="m-desc" class="bg-slate-50 p-4 rounded-xl text-sm text-slate-600 leading-relaxed border border-slate-100">
                        </div>
                </div>

                <div class="mt-8 pt-6 border-t flex justify-between items-end">
                    <span class="text-slate-400 text-sm font-medium">Precio Actual:</span>
                    <span id="m-precio" class="text-3xl font-black text-blue-600 font-mono">R$ 0.00</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let allProducts = [];
        let db = JSON.parse(localStorage.getItem('ciacollor_db')) || {};

        async function init() {
            const res = await fetch('data.json'); //
            allProducts = await res.json();
            render();
        }

        function render(search = '') {
            const grid = document.getElementById('mainGrid');
            grid.innerHTML = '';
            let count = 0;

            allProducts.forEach(p => {
                // Filtro de búsqueda
                if(search && !p.nombre.toLowerCase().includes(search.toLowerCase())) return;

                p.variantes.forEach(v => {
                    count++;
                    const sku = v.sku_id;
                    const price = db[sku]?.price || "0.00";
                    
                    const card = document.createElement('div');
                    card.className = "product-card bg-white rounded-2xl p-4 flex items-center gap-6 shadow-sm border border-slate-100";
                    card.onclick = () => openModal(p, v, price);

                    card.innerHTML = `
                        <div class="w-24 h-24 bg-slate-50 rounded-xl flex items-center justify-center flex-shrink-0">
                            <img src="imagenes/${sku}.jpg" onerror="this.src='https://via.placeholder.com/100?text=Pintura'" class="max-h-20 object-contain">
                        </div>
                        <div class="flex-grow">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-[9px] font-black uppercase px-2 py-0.5 rounded-full bg-blue-50 text-blue-500">${p.categoria}</span>
                                <span class="text-[9px] font-bold text-slate-300">#${sku}</span>
                            </div>
                            <h3 class="font-bold text-slate-800 text-sm leading-tight">${p.nombre} ${v.medida}</h3>
                            <p class="text-xl font-black text-slate-800 mt-2 font-mono">R$ ${price}</p>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            });
            document.getElementById('productCount').innerText = `${count} prods`;
        }

        function openModal(p, v, price) {
            document.getElementById('m-id').innerText = `ID: ${v.sku_id}`;
            document.getElementById('m-nombre').innerText = `${p.nombre} ${v.medida}`;
            document.getElementById('m-img').src = `imagenes/${v.sku_id}.jpg`;
            document.getElementById('m-desc').innerText = p.descripcion;
            document.getElementById('m-precio').innerText = `R$ ${price}`;
            document.getElementById('productModal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('productModal').classList.add('hidden');
        }

        document.getElementById('mainSearch').addEventListener('input', (e) => render(e.target.value));
        init();
    </script>
</body>
</html>
